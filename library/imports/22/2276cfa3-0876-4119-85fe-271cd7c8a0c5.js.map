{"version":3,"sources":["assets\\scripts\\main.js"],"names":["cc","Class","Component","properties","oneSayLabel","type","Label","loginplay","Button","visitorplay","levelLayout","Prefab","onLoad","oneSay","find","getComponent","node","on","loginLevelList","visitorLevelList","start","that","loadImg","setInterval","container","imgServeUrl","imgUrl","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","images","urlbase","window","bgUrlBase","assetManager","loadRemote","err","texture","sprite","SpriteFrame","spriteFrame","starNode","Node","name","setPosition","starSprite","addComponent","Sprite","sizeMode","width","winSize","height","addChild","open","send","url","string","hitokoto","from","loginType","CanvasNode","console","onResourceLoaded","errorMessage","loadedResource","log","newMyPrefab","instantiate","loader","loadRes"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        oneSayLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        loginplay: cc.Button,\r\n        visitorplay: cc.Button,\r\n        levelLayout: cc.Prefab\r\n    },\r\n\r\n\r\n\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n     onLoad () {\r\n        //加载一言\r\n         this.oneSay();\r\n         //开始游戏按钮\r\n         if(this.loginplay == null) this.loginplay = cc.find('Canvas/mainBg/loginplay').getComponent(cc.Button)\r\n         this.loginplay.node.on('click', this.loginLevelList, this)\r\n         if(this.visitorplay == null) this.visitorplay = cc.find('Canvas/mainBg/visitorplay').getComponent(cc.Button)\r\n         this.visitorplay.node.on('click', this.visitorLevelList, this)\r\n     },\r\n\r\n    start () {\r\n        let that = this;\r\n\r\n        this.loadImg();\r\n\r\n        setInterval(function () {\r\n            that.oneSay();\r\n        },10000)\r\n    },\r\n\r\n\r\n    // update (dt) {},\r\n\r\n    loadImg: function(){\r\n        var that = this;\r\n        let container = cc.find('Canvas/mainBg/bingBg');//图片呈现位置\r\n        var imgServeUrl = 'https://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1';\r\n        var imgUrl = '';\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response =  JSON.parse(xhr.responseText);\r\n                imgUrl = 'https://cn.bing.com' + response.images[0].urlbase + '_720x1280.jpg'\r\n                window.bgUrlBase = 'https://cn.bing.com' + response.images[0].urlbase;\r\n\r\n                cc.assetManager.loadRemote(imgUrl, function (err, texture) {\r\n                    var sprite  = new cc.SpriteFrame(texture);\r\n                    container.spriteFrame = sprite;\r\n                    //创建一个使用图片资源的新节点对象\r\n                    let starNode = new cc.Node(); //创建一个新节点\r\n                    starNode.name = \"star1\";\r\n                    starNode.setPosition(0,0);\r\n                    let starSprite = starNode.addComponent(cc.Sprite); //增加精灵组件\r\n                    starSprite.spriteFrame = sprite; //设置精灵组件图片资源\r\n                    starSprite.sizeMode = 'CUSTOM';\r\n                    starSprite.node.width = cc.winSize.width\r\n                    starSprite.node.height = cc.winSize.height\r\n                    container.addChild(starNode); //场景中增加新节点\r\n                });\r\n            }\r\n        };\r\n        xhr.open(\"get\", imgServeUrl, true);\r\n        xhr.send();\r\n    },\r\n    oneSay(){\r\n        let that = this;\r\n        let url = \"https://v1.hitokoto.cn/\";\r\n        let xhr = new XMLHttpRequest();\r\n        let oneSayLabel = cc.find(\"Canvas/mainBg/oneSay\").getComponent(cc.Component);\r\n\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response =  JSON.parse(xhr.responseText);\r\n               if(that.oneSayLabel && that.oneSayLabel.string != null) that.oneSayLabel.string = response.hitokoto + ' -- ' +  response.from;\r\n               else if(oneSayLabel && oneSayLabel.string != null ) oneSayLabel.string = response.hitokoto + ' -- ' +  response.from;\r\n            }\r\n        };\r\n        xhr.open(\"get\", url, true);\r\n        xhr.send();\r\n    },\r\n    //授权登录显示关卡列表\r\n    loginLevelList(){\r\n        window.loginType = 'wechat';\r\n        var CanvasNode = cc.find('Canvas');\r\n        if( !CanvasNode ) { cc.console( 'find Canvas error' ); return; }\r\n        var onResourceLoaded = function(errorMessage, loadedResource )\r\n        {\r\n            if( errorMessage ) { console.log( 'Prefab error:' + errorMessage ); return; }\r\n            if( !( loadedResource instanceof cc.Prefab ) ) { console.log( 'Prefab error' ); return; }\r\n            var newMyPrefab = cc.instantiate( loadedResource );\r\n            CanvasNode.addChild( newMyPrefab );\r\n        };\r\n        cc.loader.loadRes('levelLayout', onResourceLoaded );\r\n\r\n        // let levelList = cc.instantiate(this.levelLayout);\r\n        // this.node.addChild(levelList);\r\n    },\r\n    //不登录登录显示关卡列表\r\n    visitorLevelList(){\r\n        window.loginType = 'visitor';\r\n        var CanvasNode = cc.find('Canvas');\r\n        if( !CanvasNode ) { cc.console( 'find Canvas error' ); return; }\r\n        var onResourceLoaded = function(errorMessage, loadedResource )\r\n        {\r\n            if( errorMessage ) { console.log( 'Prefab error:' + errorMessage ); return; }\r\n            if( !( loadedResource instanceof cc.Prefab ) ) { console.log( 'Prefab error' ); return; }\r\n            var newMyPrefab = cc.instantiate( loadedResource );\r\n            CanvasNode.addChild( newMyPrefab );\r\n        };\r\n        cc.loader.loadRes('levelLayout', onResourceLoaded );\r\n\r\n        // let levelList = cc.instantiate(this.levelLayout);\r\n        // this.node.addChild(levelList);\r\n    }\r\n});\r\n"]}